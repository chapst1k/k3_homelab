apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: monitoring

resources:
  - namespace.yaml

  # Prometheus
  - prometheus-configmap.yaml
  - prometheus-deployment.yaml
  - prometheus-service.yaml
  - prometheus-ingress.yaml
  - prometheus-pvc.yaml

  # Loki
  - loki-configmap.yaml
  - loki-statefulset.yaml
  - loki-service.yaml
  - loki-ingress.yaml

  # Grafana
  - grafana-config-datasources.yaml
  - grafana-deployment.yaml
  - grafana-service.yaml
  - grafana-ingress.yaml
  - grafana-pvc.yaml

configMapGenerator:
  - name: grafana-dashboard-node
    namespace: monitoring
    files:
      - dashboards/node-exporter.json

  - name: grafana-dashboard-k8s
    namespace: monitoring
    files:
      - dashboards/k8s.json

  - name: grafana-dashboard-traefik
    namespace: monitoring
    files:
      - dashboards/traefik.json

  - name: grafana-dashboard-loki
    namespace: monitoring
    files:
      - dashboards/loki.json

  - name: grafana-dashboard-custom
    namespace: monitoring
    files:
      - dashboards/website.json
      - dashboards/postgres.json

# Prevent hash suffix
generatorOptions:
  disableNameSuffixHash: true
generatorOptions:
  disableNameSuffixHash: true
